function import$(t,e){var n={}.hasOwnProperty;for(var r in e)n.call(e,r)&&(t[r]=e[r]);return t}!function(){var t,e,n;t={events:{mousedown:function(t){var e;if(this.mod.dragger.contains(t.target)){for(e=t.target;e&&(!e.hasAttribute||!e.hasAttribute("draggable"));)e=e.parentNode;return e?e.setAttribute("draggable",!0):void 0}},dragstart:function(e){var n,r,i,a;if(this.mod.dragger.contains(e.target))return n=this.mod.dragger,n.src=e.target,r=/inline/.exec(getComputedStyle(n.src).display)?"inline":"block",i={mode:r},(a=e.dataTransfer).setData("application/json",JSON.stringify(i)),a.setData("mode/"+r,""),a.setDragImage(t.ghost[r],10,10),n.setDrag(!0),e.stopPropagation()},dragover:function(t){var e,n,r,i,a;if(t.preventDefault(),e=this.mod.dragger,n=ldCaret.byPtr({node:this.root,x:t.clientX,y:t.clientY,method:"euclidean"}),e.contains(n.range.startContainer))return r=t.dataTransfer.types.map(function(t){return/mode\/(.+)/.exec(t)}).filter(function(t){return t}).map(function(t){return t[1]})[0]||"inline",e.render((a={},a.range=n.range,i=a,i.mode=r,i))},drop:function(t){var e,n;return e=[t.target,this.mod.dragger],n=e[1],t.preventDefault(),n.drop({evt:t})}},ghost:{block:(e=new Image,e.src="data:image/svg+xml,"+encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" width="20" height="15" viewBox="0 0 20 15">\n<rect x="0" y="0" width="9" height="15" fill="rgba(0,0,0,.5)"/>\n<rect x="11" y="0" width="9" height="15" fill="rgba(0,0,0,.5)"/>\n</svg>'),e),inline:(e=new Image,e.src="data:image/svg+xml,"+encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" width="20" height="15" viewBox="0 0 20 15">\n<rect x="0" y="0" width="20" height="3" fill="rgba(0,0,0,.5)"/>\n<rect x="0" y="4" width="20" height="3" fill="rgba(0,0,0,.5)"/>\n<rect x="0" y="8" width="20" height="3" fill="rgba(0,0,0,.5)"/>\n<rect x="0" y="12" width="20" height="3" fill="rgba(0,0,0,.5)"/>\n</svg>'),e)},init:function(){return this.mod.dragger=new n({root:this.root,editable:this})}},n=function(t){var e;return null==t&&(t={}),this.editable=t.editable,this.opt=t,e=t.root,this.root=e="string"==typeof e?document.querySelector(e):e||null,import$(this,{dragging:!1,caret:null,src:null}),this.caret={box:null,range:null},this.evtHandler={},this.init(),this},n.prototype=import$(Object.create(Object.prototype),{init:function(){return this.caret.box=document.createElement("div"),this.caret.box.classList.add("mod-dragger-caret"),document.body.appendChild(this.caret.box)},contains:function(t){return this.root.contains(t)},setDrag:function(t){return this.dragging=t},hostmatch:function(t){var e,n,r;for(e=t.parent,n=t.mode;e;){if(e.hasAttribute&&(r=0,"block"===n&&e.hasAttribute("hostable")&&(r+=1),"inline"===n&&e.hasAttribute("editable")&&"false"!==e.getAttribute("editable")&&(r+=2),r))return{parent:e,type:r};(e=e.parentNode)===this.root&&(e=null)}return{parent:e,type:r}},render:function(t){var e,n,r,i,a;return null==t&&(t={}),(e=t.range)?((n=this.hostmatch({parent:e.startContainer,mode:t.mode})).parent,r=n.type,i=r,a=e.getBoundingClientRect(),this.caret.range=e,import$(this.caret.box.style,{left:a.x+"px",top:a.y+"px",height:a.height+"px",display:"block",opacity:i?1:.4,filter:i?"":"saturate(0)"})):(n=this.caret.box.style,n.display="none",n)},drop:function(t){var e,n,r,i,a,o,s,d,l=this;if(e=t.evt,n=[this.caret.range,this.src],r=n[0],i=n[1],this.src=null,this.render(),r&&this.root.contains(e.target))return a=r.startContainer,o=e.dataTransfer.types.map(function(t){return/mode\/(.+)/.exec(t)}).filter(function(t){return t}).map(function(t){return t[1]})[0]||"inline",i?this.insert({range:r,parent:a,mode:o,node:i}):"block"===(s=(d=e.dataTransfer.getData("application/json"))?JSON.parse(d):{}).type?blocktmp.get({name:s.data.name}).then(function(t){return deserialize(t)}).then(function(t){return ta.parentNode.insertBefore(t.node,ta),l.editable.fire("change")}).catch(function(t){return console.log(t)}):((i=document.createElement("block"===s.mode?"div":"span")).setAttribute("editable",!0),i.innerText=JSON.stringify(s),i.innerHTML=function(){switch(s.name){case"button":return'<div class="btn btn-primary"> Button </div>';case"list":return"<ul><li>List</li></ul>";case"image":return'<img src="https://www.google.com/logos/doodles/2020/december-holidays-days-2-30-6753651837108830.5-s.png"/>';case"table":return"<table><tr><td>table</td></tr></table>";default:return"dummy"}}(),this.insert({range:r,parent:a,node:i,mode:s.mode||"inline"}))},insert:function(t){var e,n,r,i,a,o,s,d,l,c,g,h,u,p,m;if(e=t.parent,n=t.range,r=t.node,i=t.mode,a=[e,n,r,i],o=a[0],a[1],s=a[2],d=a[3],l=n.startContainer,c=n.startOffset,g=l.nodeType===Element.TEXT_NODE?l:l.childNodes[c],!ld$.parent(g,null,s)&&(a=this.hostmatch({parent:o,mode:d}),e=a.parent,h=a.type,o=e)){if(1&h)for(;g&&g.parentNode!==o;)g=g.parentNode;return g.nodeType===Element.TEXT_NODE?(s.parentNode&&s.parentNode.removeChild(s),u=g.textContent,[document.createTextNode(u.substring(0,c)),s,document.createTextNode(u.substring(c))].map(function(t){return g.parentNode.insertBefore(t,g)}),g.parentNode.removeChild(g)):(s.parentNode&&s.parentNode.removeChild(s),"block"===i?(p=document.createRange(),m=document.createRange(),p.setStart(o,0),p.setEnd(l,c),m.setStart(l,c),m.setEnd(o.nextSibling||o,o.nextSibling?0:o.childNodes?o.childNodes.length:o.textContent.length),p.toString().length>m.toString().length?g.parentNode.insertBefore(s,g.nextSibling):g.parentNode.insertBefore(s,g)):g.parentNode.insertBefore(s,g)),this.editable.fire("change")}}}),((e=window.editable).mod||(e.mod={})).register("dragger",t)}();