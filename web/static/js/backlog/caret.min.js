var caretRange,caretRangeText,setCaret,selectRange;caretRange=function(e){var t,n,a,r,o,d,i,c,g,s,l,u,h,R;if(t=e.node,n=e.x,a=e.y,(r=e.range)||(r=document.createRange()),t.nodeType===Element.TEXT_NODE)return caretRangeText({node:t,x:n,y:a,range:r});for(o=null,d=0,i=t.childNodes.length;d<i;++d)c=d,g=caretRange({node:t.childNodes[c],x:n,y:a,range:r}),(!o||g.min<o.min)&&(o=g);return o||(s=t.parentNode,l=Array.from(s.childNodes),(r=document.createRange()).setStart(s,l.indexOf(t)),r.setEnd(s,l.indexOf(t)+1),h=(u=r.getBoundingClientRect()).x+u.width/2,R=u.y+u.height/2,o={min:Math.pow(h-n,2)+Math.pow(R-a,2),range:r}),o},caretRangeText=function(e){var t,n,a,r,o,d,i,c,g,s,l,u,h,R;for(t=e.node,n=e.x,a=e.y,r=document.createRange(),o=0,d=t.length+1;o<d;++o)i=o,r.setStart(t,i),g=(c=r.getBoundingClientRect()).x+c.width/2,s=c.y+c.height/2,l=Math.pow(g-n,2)+Math.pow(s-a,2),(void 0===R||null===R||l<R)&&(h=(u=[i,l])[0],R=u[1]);return r.setStart(t,h),r.setEnd(t,h),{min:R,range:r}},setCaret=function(e){var t,n,a,r;return t=e.startContainer,n=e.startOffset,e.startContainer.nodeType!==Element.TEXT_NODE&&(t=(r=[(a=function(e,t){var n,r;return e&&e.childNodes?(n=a(e.childNodes[t],0),(r=n)?r:e):e})(t,n),0])[0],n=r[1]),e.setStart(t,n),e.setEnd(t,n),selectRange(e)},selectRange=function(e){var t;return(t=window.getSelection()).removeAllRanges(),t.addRange(e)};